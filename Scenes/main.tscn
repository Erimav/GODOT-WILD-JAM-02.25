[gd_scene load_steps=13 format=3 uid="uid://e0wp0h0rrm1u"]

[ext_resource type="Script" path="res://Code/Map/MapObject.cs" id="1_ldni7"]
[ext_resource type="PackedScene" uid="uid://c04p8dpts73sm" path="res://Scenes/Prefabs/tile.tscn" id="2_3i4cd"]
[ext_resource type="PackedScene" uid="uid://cf7brgwaxlmud" path="res://Code/3d_rts_camera/rtscam.tscn" id="3_v4tk2"]
[ext_resource type="PackedScene" uid="uid://xu8wg8g0j8iw" path="res://Scenes/Controllers/player_controller.tscn" id="4_777qx"]
[ext_resource type="PackedScene" uid="uid://cmh0pr3rlh182" path="res://Scenes/Controllers/game_controller.tscn" id="5_8v0vu"]
[ext_resource type="PackedScene" uid="uid://clcoyo24wlrud" path="res://Scenes/UI/debug_ui.tscn" id="5_a5bb8"]
[ext_resource type="PackedScene" uid="uid://cd0m8r5sfu1uu" path="res://Scenes/Controllers/mob_controller.tscn" id="6_4odl5"]
[ext_resource type="PackedScene" uid="uid://cd6n5dhrorcw1" path="res://Scenes/UI/hud.tscn" id="7_bk4vi"]
[ext_resource type="PackedScene" uid="uid://ccnjexk57xyr1" path="res://Scenes/Controllers/enemy_controller.tscn" id="7_dufwh"]
[ext_resource type="PackedScene" uid="uid://dkb62k31g4xmu" path="res://Scenes/Prefabs/tower_proto.tscn" id="7_uk5tl"]

[sub_resource type="Curve3D" id="Curve3D_y6g7l"]
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 0),
"tilts": PackedFloat32Array(0, 0, 0)
}
point_count = 3

[sub_resource type="PlaneMesh" id="PlaneMesh_n5s15"]

[node name="Main" type="Node3D"]

[node name="Path3D" type="Path3D" parent="."]
curve = SubResource("Curve3D_y6g7l")

[node name="Map" type="Node3D" parent="." node_paths=PackedStringArray("ePath3D")]
script = ExtResource("1_ldni7")
ePath3D = NodePath("../Path3D")
eWidth = 10
eHeight = 10
eMimicNumber = 5
eMapTile = ExtResource("2_3i4cd")
eMapStartPosition = Vector3(0, 1, 0)
eTileColMargin = 1.5
eTileRowMargin = 1.5
eGenerateMap = true
eMarkStartAndEnd = true

[node name="MeshInstance3D" type="MeshInstance3D" parent="."]
transform = Transform3D(20, 0, 0, 0, 20, 0, 0, 0, 20, -1.66853, 0.77755, 0.415482)
mesh = SubResource("PlaneMesh_n5s15")

[node name="OmniLight3D" type="OmniLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.26545, 0)
light_energy = 2.0
omni_range = 30.0

[node name="RTScamera" parent="." instance=ExtResource("3_v4tk2")]
transform = Transform3D(1, 0, 0, 0, 0.783542, 0.621339, 0, -0.621339, 0.783542, 0, 4.50119, 3)
edge_scroll_margin = 0.0
edge_scroll_speed = 0.0

[node name="UI" type="Control" parent="."]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="HUD" parent="UI" node_paths=PackedStringArray("mGameController") instance=ExtResource("7_bk4vi")]
layout_mode = 1
mGameController = NodePath("../../GameController")

[node name="DebugUI" parent="UI" node_paths=PackedStringArray("mGameController") instance=ExtResource("5_a5bb8")]
layout_mode = 1
mGameController = NodePath("../../GameController")

[node name="EnemyController" parent="." node_paths=PackedStringArray("eMapObject", "eGameController") instance=ExtResource("7_dufwh")]
eMapObject = NodePath("../Map")
eGameController = NodePath("../GameController")
eTowersPrefabs = Array[PackedScene]([ExtResource("7_uk5tl")])

[node name="GameController" parent="." node_paths=PackedStringArray("eMobController", "eMapObject") instance=ExtResource("5_8v0vu")]
eMobController = NodePath("../MobController")
eMapObject = NodePath("../Map")

[node name="MobController" parent="." node_paths=PackedStringArray("eMapObject") instance=ExtResource("6_4odl5")]
eMapObject = NodePath("../Map")

[node name="PlayerController" parent="." instance=ExtResource("4_777qx")]

[connection signal="blockErased" from="Map" to="PlayerController" method="onErase"]
[connection signal="blockIsMimic" from="Map" to="PlayerController" method="OnMimic"]
[connection signal="blockIsTower" from="Map" to="PlayerController" method="onTower"]
[connection signal="isBlockPressed" from="Map" to="PlayerController" method="TilePressed"]
[connection signal="GameStateSetToWave" from="GameController" to="EnemyController" method="OnPrepare"]
[connection signal="TryEraseTile" from="PlayerController" to="Map" method="OnTryEraseTile"]
